{{define "BUILDS"}}
<br>
<div class="container">
  <div class="row">
    <div id="filters" class="four columns">
      <h5>{{.mainRepo.Fullname}}</h5>
      <div id="buildinfo-container">
        <label>Last Build</label><span id="status" class="{{.mainRepo.LastBuildStatus}}">{{.repo.LastBuildStatus}}<span>
      </div>
      <br>
      <button onclick="removeBtnOc(this)" class="danger" data-fn="{{.mainRepo.Fullname}}" data-id="{{.mainRepo.ID}}" type="button">Remove</button>
      <br>
      {{if gt (len .reposToShow) 1}}
      <div id="other-builds">
        All projects: <br>
        {{range .reposToShow}}
          <a href="/builds/{{.Fullname}}">{{.Fullname}}</a><br>
        {{end}}
      </div>
      {{end}}
    </div>
    <div id="build" class="eight columns">
      <code>
        {{range .buildOutPut}}
          > {{.}} <br>
        {{end}}
      </code>
    </div>
  </div>
</div>
<script>
  function removeBtnOc(btn) {
    btn.classList.add('loading')
    btn.innerHTML = "";

    var callback = function(req) {
      if(req.status == 200){
        btn.innerHTML = "Add Back";
      }
      else {
        alert('Could not remove')
      }
      btn.classList.remove('loading')
    }

    makeRequest("/remove?id=" + btn.dataset.id + '&fullname=' + btn.dataset.fn, "POST", callback);
  }

  function makeRequest(url, method, callback) {
    var req = new XMLHttpRequest();

    req.onreadystatechange = function() {
      if (req.readyState == XMLHttpRequest.DONE ) {
        callback(req);
      }
    }

    req.open(method, url);
    req.send();
  }
</script>
{{end}}